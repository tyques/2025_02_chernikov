# Java Socket Chat

Клиент-серверный чат на Java 21 с использованием сокетов, Swing и Virtual Threads.

## Технологии

* **Java 21** (Virtual Threads)
* **Gradle** (сборка)
* **Swing** (GUI клиента)
* **Jackson** (JSON сериализация)
* **Logback/SLF4J** (логирование)

## Сборка

Проект собирается в два исполняемых fat-jar (со всеми зависимостями) с помощью Gradle.

В корне проекта выполните:

```bash
./gradlew clean serverJar clientJar
```

*(Для Windows: `./gradlew.bat clean serverJar clientJar`)*

Артефакты появятся в папке `build/libs/`.

## Запуск

### 1. Сервер

Запускает сервер на порту `8189` (по умолчанию).

```bash
java -jar chat-server-1.0-SNAPSHOT.jar 
```

Чтобы изменить порт, создайте файл `server.properties` в одной папке с jar-файлом (или в resources перед сборкой) с
содержимым:

```properties
server.port=9000
```

### 2. Клиент

Запускает графическое приложение чата. Можно запустить несколько экземпляров.

```bash
java -jar chat-client-1.0-SNAPSHOT.jar 
```

## Основной функционал

* **Обмен сообщениями в реальном времени**
    * Мгновенная доставка текстовых сообщений всем подключенным участникам через TCP сокеты.
* **Умная синхронизация истории (Delta Sync)**
    * Хранение истории сообщений на сервере.
    * **Оптимизированная догрузка:** При переподключении (после разрыва связи) клиент автоматически запрашивает только
      те сообщения, которые были пропущены за время офлайна (начиная с последнего известного индекса). Это исключает
      дубликаты и экономит трафик.
* **Автоматическое переподключение (Resilience)**
    * Клиент самостоятельно обнаруживает потерю соединения.
    * Реализован механизм экспоненциальной или фиксированной задержки перед попыткой повторного подключения к серверу
      без перезапуска приложения.
* **Мониторинг участников (Presence)**
    * Отображение списка активных пользователей в реальном времени.
    * Мгновенное обновление списка при входе или выходе участников.
* **Системные уведомления**
    * Специальные сообщения в чате о событиях (например: *"Клиент Иван присоединился к чату"*, *"Клиент Дарья
      отключился"*).
* **Валидация авторизации**
    * Проверка уникальности никнейма при входе.
    * Отказ в доступе с информативным сообщением, если имя уже занято.
* **Потокобезопасная архитектура**
    * Сервер обрабатывает каждого клиента в отдельном виртуальном потоке (`Thread.ofVirtual()`), что позволяет
      выдерживать большое количество одновременных подключений.
    * Корректная синхронизация отправки сообщений для предотвращения "гонки потоков" (Race Conditions) при одновременном
      бродкасте и запросе истории.